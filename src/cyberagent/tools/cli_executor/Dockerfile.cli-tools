# CyberneticAgents Docker image for CLI-based agent skills.
FROM node:22-slim

RUN apt-get update && apt-get install -y --no-install-recommends \
    ca-certificates \
    curl \
    git \
    jq \
    less \
    python3 \
    python3-pip \
    ripgrep \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Install Brave search CLI from upstream repository.
RUN python3 -m pip install --no-cache-dir \
    git+https://github.com/joshsisto/brave-search-cli.git

# Readability-based web fetch helper exposed as a CLI.
RUN python3 -m pip install --no-cache-dir \
    requests \
    git+https://github.com/buriy/python-readability.git
RUN cat <<'PY' > /usr/local/bin/web-fetch \
#!/usr/bin/env python3
import sys
import requests
from readability import Document

if len(sys.argv) != 2:
    print("Usage: web-fetch <url>", file=sys.stderr)
    sys.exit(2)

url = sys.argv[1]
response = requests.get(url, timeout=20)
response.raise_for_status()
doc = Document(response.text)
print(doc.summary())
PY
RUN chmod +x /usr/local/bin/web-fetch

RUN git --version && rg --version

CMD ["bash"]
